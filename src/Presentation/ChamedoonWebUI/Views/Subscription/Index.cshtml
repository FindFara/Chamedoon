@model ChamedoonWebUI.Models.SubscriptionPageViewModel
@{
    ViewData["Title"] = "ุงูุชุฎุงุจ ุงุดุชุฑุงฺฉ";
}

@section Styles {
    <link rel="stylesheet" href="~/css/subscription.css" asp-append-version="true" />
}

<section class="subscription-showcase py-5 py-lg-6">
    <div class="container">
        <div class="subscription-hero">
            <div>
                <p class="subscription-tag">ุงุฑุฒุงุจ ุดุงูุณ ููุงุฌุฑุช</p>
                <h1>ูพูู ุงุดุชุฑุงฺฉ ูุฎุตูุต ุฎูุฏุช ุฑุง ุงูุชุฎุงุจ ฺฉู</h1>
                <p class="subscription-lead">ุชูุงู ูพููโูุง ุจุง ุชุฎูู ูฺู ุฎุฑุฏ ุงูู ูุนุงู ูโุดููุฏ ู ุฑู ููุจุงู ูู ูโุชูุงู ููู ฺฏุฒููโูุง ุฑุง ฺฉูุงุฑ ูู ุจุจู.</p>
            </div>
            <div class="subscription-status">
                <p class="subscription-status__title">ูุถุนุช ุงุดุชุฑุงฺฉ ูุนู</p>
                @if (Model.CurrentSubscription is null)
                {
                    <p class="subscription-status__value text-muted mb-2">ูุนูุงู ุงุดุชุฑุงฺฉ ุจุฑุงุช ุซุจุช ูุดุฏู.</p>
                    <p class="subscription-status__meta">ุฑู ฺฉ ุงุฒ ูพููโูุง ุจุฒู ู ุณุฑุน ูุนุงูุด ฺฉู.</p>
                }
                else
                {
                    <p class="subscription-status__value">@Model.CurrentSubscription.PlanTitle</p>
                    <p class="subscription-status__meta">@Model.CurrentSubscription.RemainingDays ุฑูุฒ ุจุงู ูุงูุฏู</p>
                    @if (Model.CurrentSubscription.EvaluationLimit is null)
                    {
                        <p class="subscription-status__meta">ุงุณุชุนูุงู ูุงูุญุฏูุฏ ูุนุงู ุงุณุช.</p>
                    }
                    else
                    {
                        <p class="subscription-status__meta">@Model.CurrentSubscription.UsedEvaluations ุงุฒ @Model.CurrentSubscription.EvaluationLimit ุงุณุชุนูุงู ุงุณุชูุงุฏู ุดุฏู</p>
                    }
                }
            </div>
        </div>

        @if (!string.IsNullOrWhiteSpace(Model.AlertMessage))
        {
            <div class="alert alert-info subscription-alert" role="alert">
                @Model.AlertMessage
            </div>
        }

        <div class="plan-stack" role="list">
            @for (var index = 0; index < Model.Plans.Count; index++)
            {
                var plan = Model.Plans[index];
                var isCurrent = Model.CurrentSubscription?.PlanId == plan.Id;
                <article class="plan-card @(plan.IncludesAI ? "plan-card--ai" : string.Empty) @(isCurrent ? "plan-card--active" : string.Empty)" role="listitem">
                    <div class="plan-card__head">
                        <div class="plan-card__badge">
                            <span class="plan-card__index">@((index + 1).ToString("00"))</span>
                            <div>
                                <small>ุงุดุชุฑุงฺฉ ูุงูุงูู</small>
                                <strong>@plan.DurationLabel</strong>
                            </div>
                        </div>
                        @if (plan.IncludesAI)
                        {
                            <span class="plan-card__pill plan-card__pill--ai">+ ููุด ูุตููุน</span>
                        }
                        else if (plan.EvaluationLimit is null)
                        {
                            <span class="plan-card__pill">ูุงูุญุฏูุฏ</span>
                        }
                        else
                        {
                            <span class="plan-card__pill">@plan.EvaluationLimit ุงุณุชุนูุงู</span>
                        }
                    </div>
                    <div class="plan-card__body">
                        <div>
                            <h3>@plan.Title</h3>
                            <ul class="plan-card__features">
                                @foreach (var feature in plan.Features)
                                {
                                    <li>
                                        <span aria-hidden="true">โ</span>
                                        <span>@feature</span>
                                    </li>
                                }
                                @if (plan.EvaluationLimit is null)
                                {
                                    <li>
                                        <span aria-hidden="true">โพ๏ธ</span>
                                        <span>ุงุณุชุนูุงู ูุงูุญุฏูุฏ ุจุฏูู ูุญุฏูุฏุช</span>
                                    </li>
                                }
                                else
                                {
                                    <li>
                                        <span aria-hidden="true">๐ฏ</span>
                                        <span>ุญุฏุงฺฉุซุฑ @plan.EvaluationLimit ุงุณุชุนูุงู ุฏุฑ ูุฑ ุฏูุฑู</span>
                                    </li>
                                }
                            </ul>
                        </div>
                        <div class="plan-card__pricing">
                            <div class="plan-card__amounts">
                                <span class="plan-card__current">@plan.Price.ToString("N0") <small>ุชููุงู</small></span>
                                <span class="plan-card__old">@plan.OriginalPrice.ToString("N0") ุชููุงู</span>
                            </div>
                            <span class="plan-card__discount">@plan.SavingsAmount.ToString("N0") ุชููุงู ุชุฎูู ุฎุฑุฏ ุงูู</span>
                            @if (plan.DiscountPercent > 0)
                            {
                                <span class="plan-card__percent">%@plan.DiscountPercent ุงุฑุฒุงูโุชุฑ</span>
                            }
                            <form asp-action="Subscribe" method="post">
                                @Html.AntiForgeryToken()
                                <input type="hidden" name="planId" value="@plan.Id" />
                                <button type="submit" class="btn btn-light w-100" @(isCurrent ? "disabled" : string.Empty)>
                                    @(isCurrent ? "ุฏุฑ ุญุงู ุงุณุชูุงุฏู" : "ุดุฑูุน ุงุฑุฒุงุจ")
                                </button>
                            </form>
                        </div>
                    </div>
                </article>
            }
        </div>
    </div>
</section>
