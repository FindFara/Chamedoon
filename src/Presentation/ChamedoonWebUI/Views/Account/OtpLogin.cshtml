@{
    ViewData["Title"] = "ÙˆØ±ÙˆØ¯ Ø¨Ø§ Ø±Ù…Ø² ÛŒÚ©Ø¨Ø§Ø± Ù…ØµØ±Ù";
    Layout = "~/Views/Shared/AuthLayout.cshtml";
}

<section class="glass-section auth-section login-centered">
    <div class="container">
        <div class="auth-card-shell">
            <div class="glass-card auth-card auth-card-simple text-center">
                <div class="auth-icon-badge" aria-hidden="true">ğŸ“§</div>
                <div class="auth-card-header text-center">
                    <h2>ÙˆØ±ÙˆØ¯ Ø¨Ø§ Ø±Ù…Ø² ÛŒÚ©Ø¨Ø§Ø± Ù…ØµØ±Ù</h2>
                    <p class="auth-subtitle">Ú©Ø¯ ÛŒÚ©Ø¨Ø§Ø± Ù…ØµØ±Ù Ø±Ø§ Ø¨Ø§ Ø§ÛŒÙ…ÛŒÙ„Øª Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†</p>
                </div>
                <form class="otp-form" novalidate>
                    <div class="glass-field" id="otpEmailWrapper">
                        <label for="otpEmail" class="form-label text-end w-100">Ø§ÛŒÙ…ÛŒÙ„</label>
                        <input id="otpEmail" type="email" class="form-control glass-input" placeholder="example@mail.com" required />
                        <span class="text-danger small d-none" id="otpEmailError">Ù„Ø·ÙØ§ ÛŒÚ© Ø§ÛŒÙ…ÛŒÙ„ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†.</span>
                    </div>
                    <div class="glass-field d-none" id="otpCodeWrapper">
                        <label for="otpCode" class="form-label text-end w-100">Ú©Ø¯ Ú†Ù‡Ø§Ø± Ø±Ù‚Ù…ÛŒ</label>
                        <input id="otpCode" type="text" inputmode="numeric" maxlength="4" class="form-control glass-input" placeholder="OTP-Ú©Ø¯" />
                        <p class="glass-helper mb-0">Ú©Ø¯ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯Ù‡ Ø¨Ù‡ Ø§ÛŒÙ…ÛŒÙ„Øª Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†.</p>
                    </div>
                    <div class="text-danger small d-none" id="otpStatus"></div>
                    <button type="button" class="btn-auth-primary w-100" id="otpContinue">Ø§Ø¯Ø§Ù…Ù‡</button>
                </form>
                <div class="auth-meta text-center">
                    <a asp-controller="Account" asp-action="Login" class="auth-otp-link">Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ÙˆØ±ÙˆØ¯ Ø¨Ø§ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±</a>
                </div>
            </div>
        </div>
    </div>
</section>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const emailInput = document.getElementById('otpEmail');
            const codeInput = document.getElementById('otpCode');
            const emailWrapper = document.getElementById('otpEmailWrapper');
            const codeWrapper = document.getElementById('otpCodeWrapper');
            const continueButton = document.getElementById('otpContinue');
            const emailError = document.getElementById('otpEmailError');
            const statusMessage = document.getElementById('otpStatus');

            let codeRequested = false;

            continueButton.addEventListener('click', function () {
                if (!codeRequested) {
                    const emailValue = emailInput.value.trim();
                    const isValidEmail = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailValue);

                    if (!isValidEmail) {
                        emailError.classList.remove('d-none');
                        statusMessage.classList.add('d-none');
                        return;
                    }

                    emailError.classList.add('d-none');
                    statusMessage.textContent = 'Ú©Ø¯ ÙˆØ±ÙˆØ¯ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ…ÛŒÙ„ ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù‡ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯.';
                    statusMessage.classList.remove('d-none');
                    emailWrapper.classList.add('d-none');
                    codeWrapper.classList.remove('d-none');
                    continueButton.textContent = 'ØªØ§ÛŒÛŒØ¯ Ú©Ø¯';
                    codeRequested = true;
                    codeInput.focus();
                } else {
                    statusMessage.textContent = 'Ú©Ø¯ ÙˆØ§Ø±Ø¯ Ø´Ø¯Ù‡ Ø«Ø¨Øª Ø´Ø¯.';
                    statusMessage.classList.remove('d-none');
                }
            });
        });
    </script>
}
